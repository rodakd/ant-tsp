var P=Object.defineProperty;var D=(c,n,i)=>n in c?P(c,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[n]=i;var r=(c,n,i)=>(D(c,typeof n!="symbol"?n+"":n,i),i);(function(){"use strict";const i=(e,t)=>{const[s,a]=e,[p,h]=t;if(a===h&&s===p)return 0;const d=Math.PI*a/180,l=Math.PI*h/180,g=s-p,E=Math.PI*g/180;let o=Math.sin(d)*Math.sin(l)+Math.cos(d)*Math.cos(l)*Math.cos(E);return o>1&&(o=1),o=Math.acos(o),o=o*180/Math.PI,o*60*1.1515*1.609344},m=e=>e!=null&&e.length?e.slice(0,-1).map((t,s)=>i(t,e[s+1])).reduce((t,s)=>t+s,0):0,f=e=>{let t=new u;onmessage=async s=>{var p;if(!((p=s==null?void 0:s.data)!=null&&p.type))return;const a=s.data;switch(a.type){case"run":t=new u,t.params=a.params,t.markers=a.markers,t.speedPercent=a.speedPercent,t.performanceMode=a.performanceMode,t.iterationsLimit=a.iterationsLimit,e(t,a.params).catch(()=>null);break;case"stop":t.running=!1;break;case"pause":t.paused=!0;break;case"resume":t.paused=!1;break;case"changeSpeed":t.speedPercent=a.speedPercent}}};class u{constructor(){r(this,"paused",!1);r(this,"running",!0);r(this,"bestTour",null);r(this,"currentTour",null);r(this,"iteration",0);r(this,"markers",[]);r(this,"params",{});r(this,"speedPercent",60);r(this,"performanceMode",!1);r(this,"iterationsLimit",null)}updateBestTour(t){this.bestTour=t,this.appDispatch({type:"updateBestTour",bestTour:t})}updateIteration(t){if(this.iteration=t,this.iterationsLimit&&this.iteration>this.iterationsLimit)return this.end();this.appDispatch({type:"updateIteration",iteration:t})}updateCurrentTour(t){this.currentTour=t,this.appDispatch({type:"updateCurrentTour",currentTour:t})}async sleep(){if(!this.running)throw"Stopped";if(this.performanceMode)return;for(;this.paused&&this.running;)await new Promise(s=>setTimeout(s,200));const t=500-this.speedPercent/100*500;return new Promise(s=>setTimeout(s,t))}log(t){this.appDispatch({type:"log",toLog:JSON.stringify(t)})}error(t){this.appDispatch({type:"error",text:t})}calculateCost(t){return m(t)}end(){throw this.appDispatch({type:"end"}),this.running=!1,"Stopped"}appDispatch(t){if(!this.running)throw"Stopped";postMessage(t)}}async function M(e){for(;e.running;)e.updateIteration(e.iteration+1),await e.sleep()}f(M)})();
